---
import type { GetStaticPaths } from "astro";
import PageLayout from "../../layouts/PageLayout.astro"
import { getCollection } from "astro:content";
import type { CollectionEntry } from "astro:content";
import { formatDate } from "../../utils/formatDate";

export async function  getStaticPaths (){
    const posts = (await getCollection('blog'))
        .filter(post => !post.data.draft)
        .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

    return posts.map((post) => ({
        params: {slug: post.slug},
        props: post
    }));
};
type Props = CollectionEntry<'blog'>;

const post = Astro.props;
const { Content } = await post.render();
---

<PageLayout title = {post.data.title}>
    <main class="container mx-auto px-8 py-16">
        <article class="prose prose-post dark:prose-invert">
            <header class="mb-8">
                <h1 class="text-2xl mb-2">{post.data.title}</h1>
                <time datetime={post.data.date.toString()} class="text-sm text-neutral-400 dark:text-neutral-600">{formatDate(post.data.date, true)}</time>
            </header>
            <Content />
        </article>
    </main>
</PageLayout>